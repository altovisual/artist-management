# ğŸ“Š Sistema de Reportes Financieros Profesionales

## DescripciÃ³n General

El sistema de exportaciÃ³n de reportes financieros genera archivos Excel (.xlsx) profesionales y completamente formateados con mÃºltiples hojas de anÃ¡lisis.

## ğŸ¯ CaracterÃ­sticas Principales

### âœ¨ DiseÃ±o Profesional
- **Formato Excel nativo** (.xlsx) - No CSV simple
- **MÃºltiples hojas de anÃ¡lisis** organizadas por tema
- **Anchos de columna optimizados** para mejor legibilidad
- **Formato de moneda consistente** con separadores de miles
- **Fechas localizadas** en formato espaÃ±ol

### ğŸ“‘ Estructura del Reporte

El reporte generado contiene **4 hojas principales**:

#### 1ï¸âƒ£ **Executive Summary** (Resumen Ejecutivo)
```
ARTIST MANAGEMENT SYSTEM
Financial Report

Generated: [Fecha y hora completa]
Period: [Rango de fechas si aplica]
Artist: [Nombre del artista o "All Artists"]

EXECUTIVE SUMMARY
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Metric              â”‚ Amount       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Total Income        â”‚ $XX,XXX.XX   â”‚
â”‚ Total Expenses      â”‚ $XX,XXX.XX   â”‚
â”‚ Net Balance         â”‚ $XX,XXX.XX   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STATISTICS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Total Transactions      â”‚ XXX     â”‚
â”‚ Income Transactions     â”‚ XXX     â”‚
â”‚ Expense Transactions    â”‚ XXX     â”‚
â”‚ Average Transaction     â”‚ $XXX.XX â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2ï¸âƒ£ **Transactions** (Detalle de Transacciones)
```
TRANSACTION DETAILS

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Date       â”‚ Artist   â”‚ Category â”‚ Description â”‚ Type    â”‚ Amount   â”‚ Running Balance  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 01/11/2024 â”‚ Marval   â”‚ Royalty  â”‚ Spotify Q4  â”‚ Income  â”‚ $1,500.00â”‚ $1,500.00        â”‚
â”‚ 05/11/2024 â”‚ Marval   â”‚ Marketingâ”‚ Instagram   â”‚ Expense â”‚ -$250.00 â”‚ $1,250.00        â”‚
â”‚ ...        â”‚ ...      â”‚ ...      â”‚ ...         â”‚ ...     â”‚ ...      â”‚ ...              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TOTALS:
Total Income:    $XX,XXX.XX
Total Expenses: -$XX,XXX.XX
Net Balance:     $XX,XXX.XX
```

**CaracterÃ­sticas especiales:**
- âœ… Ordenadas cronolÃ³gicamente
- âœ… Balance acumulado (Running Balance)
- âœ… Totales al final de la hoja
- âœ… Formato de moneda con signo negativo para gastos

#### 3ï¸âƒ£ **Category Analysis** (AnÃ¡lisis por CategorÃ­a)
```
CATEGORY ANALYSIS

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Category            â”‚ Transactions â”‚ Income   â”‚ Expenses â”‚ Net      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Royalties           â”‚ 45           â”‚ $8,500.00â”‚ $0.00    â”‚ $8,500.00â”‚
â”‚ Marketing           â”‚ 23           â”‚ $0.00    â”‚ $2,300.00â”‚-$2,300.00â”‚
â”‚ Production          â”‚ 18           â”‚ $3,200.00â”‚ $1,800.00â”‚ $1,400.00â”‚
â”‚ ...                 â”‚ ...          â”‚ ...      â”‚ ...      â”‚ ...      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ordenamiento:**
- CategorÃ­as ordenadas por volumen total (Income + Expenses)
- Muestra el balance neto por categorÃ­a

#### 4ï¸âƒ£ **Artist Analysis** (AnÃ¡lisis por Artista)
```
ARTIST ANALYSIS

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Artist              â”‚ Transactions â”‚ Income   â”‚ Expenses â”‚ Net Balance â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Marval              â”‚ 104          â”‚ $15,500.00â”‚$3,200.00â”‚ $12,300.00 â”‚
â”‚ Dimelo Super        â”‚ 87           â”‚ $12,300.00â”‚$2,800.00â”‚ $9,500.00  â”‚
â”‚ ...                 â”‚ ...          â”‚ ...      â”‚ ...      â”‚ ...        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Nota:** Esta hoja solo se genera si hay mÃºltiples artistas en el reporte.

**Ordenamiento:**
- Artistas ordenados por balance neto (de mayor a menor)

## ğŸš€ CÃ³mo Usar

### Desde la Interfaz Web

1. **Navega a Finance** (`/dashboard/finance`)
2. **Aplica filtros** (opcional):
   - Selecciona un artista especÃ­fico
   - Filtra por tipo (Income/Expense)
   - Selecciona categorÃ­a
   - Define rango de fechas
   - Busca por descripciÃ³n
3. **Click en "Export Professional Report"**
4. El archivo se descargarÃ¡ automÃ¡ticamente

### Nombre del Archivo

```
Financial_Report_YYYY-MM-DD.xlsx
```

Ejemplo: `Financial_Report_2024-11-05.xlsx`

## ğŸ’¡ Casos de Uso

### ğŸ“ˆ Reporte Mensual
```typescript
// Filtrar por mes actual
Start Date: 01/11/2024
End Date: 30/11/2024
Artist: All Artists
```

### ğŸ‘¤ Reporte Individual de Artista
```typescript
// Solo un artista especÃ­fico
Artist: Marval
Date Range: Todo el perÃ­odo
```

### ğŸ’° AnÃ¡lisis de Ingresos
```typescript
// Solo transacciones de ingreso
Type: Income
Category: All
```

### ğŸ“Š AnÃ¡lisis por CategorÃ­a
```typescript
// Gastos de marketing
Type: Expense
Category: Marketing
```

## ğŸ¨ Formato y Estilo

### Formato de Moneda
- **SÃ­mbolo:** `$` (dÃ³lar)
- **Separador de miles:** `,` (coma)
- **Decimales:** Siempre 2 dÃ­gitos
- **Ejemplo:** `$1,234.56`

### Formato de Fecha
- **Locale:** EspaÃ±ol (es-ES)
- **Formato corto:** `DD/MM/YYYY`
- **Formato largo:** `dÃ­a de mes de aÃ±o, HH:MM`

### Anchos de Columna
Optimizados automÃ¡ticamente para cada tipo de contenido:
- Fechas: 12 caracteres
- Nombres: 20-25 caracteres
- Descripciones: 35 caracteres
- Montos: 15-18 caracteres

## ğŸ”§ PersonalizaciÃ³n

### Modificar el Exportador

Archivo: `lib/export-financial-report.ts`

```typescript
// Agregar una nueva hoja
const customSheet = XLSX.utils.aoa_to_sheet([
  ['Custom Analysis'],
  ['Your data here']
]);

XLSX.utils.book_append_sheet(workbook, customSheet, 'Custom');
```

### Cambiar Formato de Moneda

```typescript
// En export-financial-report.ts
const formatCurrency = (amount: number) => {
  return amount.toLocaleString('es-ES', { 
    style: 'currency',
    currency: 'EUR' // Cambiar a EUR, COP, etc.
  });
};
```

## ğŸ“‹ Requisitos TÃ©cnicos

### Dependencias
```json
{
  "xlsx": "^0.18.5"
}
```

### Navegadores Soportados
- âœ… Chrome/Edge (Chromium)
- âœ… Firefox
- âœ… Safari
- âœ… Opera

### TamaÃ±o de Archivo
- **PequeÃ±o** (< 100 transacciones): ~15 KB
- **Mediano** (100-1000 transacciones): ~50 KB
- **Grande** (> 1000 transacciones): ~200 KB

## ğŸ› Troubleshooting

### El archivo no se descarga
1. Verifica que el navegador permita descargas
2. Revisa la consola del navegador para errores
3. AsegÃºrate de tener transacciones para exportar

### Formato incorrecto
1. Verifica que la librerÃ­a `xlsx` estÃ© instalada
2. Limpia el cachÃ© del navegador
3. Prueba en modo incÃ³gnito

### Datos faltantes
1. Confirma que los filtros no estÃ©n demasiado restrictivos
2. Verifica que haya transacciones en el rango seleccionado
3. Revisa los permisos de usuario (admin vs artist)

## ğŸ¯ PrÃ³ximas Mejoras

- [ ] Agregar logo de la empresa en la primera hoja
- [ ] GrÃ¡ficos embebidos en Excel
- [ ] ExportaciÃ³n a PDF
- [ ] Plantillas personalizables
- [ ] ProgramaciÃ³n de reportes automÃ¡ticos
- [ ] EnvÃ­o por email
- [ ] Comparativas mes a mes
- [ ] Proyecciones financieras

## ğŸ“ Soporte

Para reportar problemas o sugerir mejoras:
- Crea un issue en el repositorio
- Contacta al equipo de desarrollo
